{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Thiết lập giá cuối tuần</title>
    <link rel="stylesheet" href="{% static 'app/css/giacuoituan.css' %}">
</head>
<body>
<div class="start-container">
    <div class="start-header fixed-header">
        <a href="{% url 'home' %}">
            <img src="{% static 'app/images/logo.jpg' %}" alt="logo">
        </a>
        <div class="header-actions">
            <button class="btn btnThacMac">Bạn có thắc mắc?</button>
            <button class="btn btnLuuThoat">Lưu và thoát</button>
        </div>
    </div>

    <div class="step-main scroll-area centered">
        <div class="step-content">
            <h1 class="title">Thêm phí phụ trội cho Thứ Bảy và Chủ Nhật</h1>
            <p class="desc">Khách sẵn sàng trả thêm cho cuối tuần? Tăng giá để tối đa hóa doanh thu.</p>

            <div class="field">
                <label for="weekendPrice">Phí phụ trội cuối tuần (VND)</label>
                <div class="input-wrap"><span class="prefix">₫</span><input type="number" id="weekendPrice" value="0" min="0" step="50000"></div>
                <small>Phụ phí thêm cho các đêm thứ Sáu & thứ Bảy.</small>
            </div>

            <div class="field">
                <label>
                    <input type="checkbox" id="applyWeekend" checked>
                    <span>Áp dụng phụ phí cuối tuần</span>
                </label>
            </div>

            <div class="summary">
                <div class="summary-line"><span>Giá ngày trong tuần</span><span id="weekdayRate">₫800,000</span></div>
                <div class="summary-line"><span>Phụ phí cuối tuần</span><span id="weekendRate">₫0</span></div>
                <div class="summary-line total"><span>Giá cuối tuần</span><span id="totalWeekend">₫800,000</span></div>
            </div>
        </div>
    </div>

    <div class="start-footer fixed-footer">
        <a href="{% url 'thietlapgia' %}" class="back-link">Quay lại</a>
        <a href="{% url 'chiasett' %}" class="next-btn" id="nextBtn">Tiếp theo</a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const fmt = (n) => new Intl.NumberFormat('vi-VN').format(Math.max(0, Math.round(n)));
        const weekendInput = document.getElementById('weekendPrice');
        const applyCheckbox = document.getElementById('applyWeekend');
        const weekdayRate = document.getElementById('weekdayRate');
        const weekendRate = document.getElementById('weekendRate');
        const totalWeekend = document.getElementById('totalWeekend');

        // Lấy giá từ session hoặc localStorage (nếu có)
        const basePrice = sessionStorage.getItem('basePrice') || 800000;
        weekdayRate.textContent = `₫${fmt(basePrice)}`;

        function updateSummary() {
            const weekend = applyCheckbox.checked ? Number(weekendInput.value) || 0 : 0;
            weekendRate.textContent = `₫${fmt(weekend)}`;
            totalWeekend.textContent = `₫${fmt(Number(basePrice) + weekend)}`;
        }

        ['input', 'change'].forEach(evt => {
            weekendInput.addEventListener(evt, updateSummary);
            applyCheckbox.addEventListener(evt, updateSummary);
        });
        updateSummary();

        document.getElementById('nextBtn').addEventListener('click', (e) => {
            e.preventDefault();
            // Lưu dữ liệu nếu cần
            sessionStorage.setItem('weekendPrice', weekendInput.value);
            window.location.href = document.getElementById('nextBtn').getAttribute('href');
        });
    });
</script>
</body>
</html>
