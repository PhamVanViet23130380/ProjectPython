{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Thiết lập giá</title>
    <link rel="stylesheet" href="{% static 'app/css/thietlapgia.css' %}">
</head>
<body>
<div class="start-container">
    <div class="start-header fixed-header">
        <a href="{% url 'home' %}">
            <img src="{% static 'app/images/logo.jpg' %}" alt="logo">
        </a>
        <div class="header-actions">
            <button class="btn btnThacMac">Bạn có thắc mắc?</button>
            <button class="btn btnLuuThoat">Lưu và thoát</button>
        </div>
    </div>

    <form method="POST" action="{% url 'thietlapgia' %}">
        {% csrf_token %}
        <div class="step-main scroll-area centered">
        <div class="step-content">
            <h1 class="title">Bây giờ, hãy đặt giá cơ sở cho ngày trong tuần</h1>
            <p class="desc">Đặt giá cơ bản, phí dọn dẹp, áp dụng giảm giá và sẵn sàng đăng chỗ ở.</p>

            <div class="field">
                <label for="basePrice">Giá mỗi đêm (VND)</label>
                <div class="input-wrap"><span class="prefix">₫</span><input type="number" id="basePrice" name="price_per_night" value="800000" min="100000" step="50000" required></div>
                <small>Giá bạn muốn thu cho 1 đêm lưu trú.</small>
            </div>

            <div class="summary">
                <div class="summary-line"><span>Tạm tính mỗi đêm</span><span id="sumNight">₫800,000</span></div>
                <div class="summary-line total"><span>Tổng ước tính</span><span id="sumTotal">₫800,000</span></div>
            </div>
        </div>
    </div>

    <div class="start-footer fixed-footer">
        <a href="{% url 'tieude' %}" class="back-link">Quay lại</a>
        <button type="submit" class="next-btn" id="nextBtn">Tiếp theo</button>
    </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const fmt = (n) => new Intl.NumberFormat('vi-VN').format(Math.max(0, Math.round(n)));
        const baseInput = document.getElementById('basePrice');
        const sumNight = document.getElementById('sumNight');
        const sumTotal = document.getElementById('sumTotal');

        function updateSummary() {
            const base = Number(baseInput.value) || 0;
            const baseAfter = base; // no discount input on this page
            sumNight.textContent = `₫${fmt(baseAfter)}`;
            sumTotal.textContent = `₫${fmt(baseAfter)}`;
        }

        ['input', 'change'].forEach(evt => {
            baseInput.addEventListener(evt, updateSummary);
        });
        updateSummary();

        // Publish handled via final step; here we just submit pricing
        // Submit handled by form
    });
</script>
</body>
</html>
