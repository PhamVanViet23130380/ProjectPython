{% extends 'app/base.html' %}

{% block content %}
<div class="container user-orders">
  <h1>Lịch sử đặt phòng</h1>

  {% if bookings %}
    <table class="table table-striped">
      <thead>
        <tr>
          <th>ID</th>
          <th>Chỗ ở</th>
          <th>Ngày nhận</th>
          <th>Ngày trả</th>
          <th>Tổng tiền</th>
          <th>Trạng thái</th>
          <th>Ngày tạo</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for b in bookings %}
          <tr>
            <td>{{ b.booking_id }}</td>
            <td>
              {% if b.listing %}
                <a href="{% url 'listing_detail' listing_id=b.listing.listing_id %}">{{ b.listing.title }}</a>
              {% else %}
                (không có)
              {% endif %}
            </td>
            <td>{{ b.check_in }}</td>
            <td>{{ b.check_out }}</td>
            <td>{% if b.total_price %}{{ b.total_price }}{% else %}-{% endif %}</td>
            <td>{{ b.booking_status|default:'-' }}</td>
            <td>{{ b.created_at|date:"Y-m-d H:i" }}</td>
            <td><a class="btn btn-sm btn-outline-primary" href="{% url 'booking_detail' booking_id=b.booking_id %}">Chi tiết</a></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if bookings.has_other_pages %}
      <nav aria-label="Page navigation">
        <ul class="pagination">
          {% if bookings.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ bookings.previous_page_number }}">Trước</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Trước</span></li>
          {% endif %}
          <li class="page-item active"><span class="page-link">{{ bookings.number }} / {{ bookings.paginator.num_pages }}</span></li>
          {% if bookings.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ bookings.next_page_number }}">Sau</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Sau</span></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}

  {% else %}
    <p>Bạn chưa có đơn đặt phòng nào.</p>
  {% endif %}

</div>
{% endblock %}
