{% extends 'app/base.html' %}

{% block content %}
<div class="container user-wishlist">
  <h1>Danh sách yêu thích</h1>

  {% if wishlist %}
    <div class="row">
      {% for item in wishlist %}
        <div class="col-md-4 mb-3">
          <div class="card h-100">
            {% if item.listing and item.listing.images.all|length > 0 %}
              <img src="{{ item.listing.images.all.0.image_url }}" class="card-img-top" alt="{{ item.listing.title }}">
            {% endif %}
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">
                {% if item.listing %}
                  <a href="{% url 'listing_detail' listing_id=item.listing.listing_id %}">{{ item.listing.title }}</a>
                {% else %}
                  (Chỗ ở đã xóa)
                {% endif %}
              </h5>
              <p class="card-text mb-2">{% if item.listing and item.listing.price_per_night %}{{ item.listing.price_per_night }} / đêm{% endif %}</p>
              <div class="mt-auto">
                <a href="{% url 'listing_detail' listing_id=item.listing.listing_id %}" class="btn btn-sm btn-primary">Xem chi tiết</a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    {% if wishlist.has_other_pages %}
      <nav aria-label="Page navigation">
        <ul class="pagination">
          {% if wishlist.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ wishlist.previous_page_number }}">Trước</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Trước</span></li>
          {% endif %}
          <li class="page-item active"><span class="page-link">{{ wishlist.number }} / {{ wishlist.paginator.num_pages }}</span></li>
          {% if wishlist.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ wishlist.next_page_number }}">Sau</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Sau</span></li>
          {% endif %}
        </ul>
      </nav>
    {% endif %}

  {% else %}
    <p>Bạn chưa có chỗ ở yêu thích nào.</p>
  {% endif %}

</div>
{% endblock %}
