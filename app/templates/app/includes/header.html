{% load static %}
<header>
    <nav class="ab-header">
        <div class="ab-left">
            <div class="logo-wrap">
                <a href="{% url 'home' %}">
                    <img src="{% static 'app/images/logo.jpg' %}" class="ab-logo" alt="Home Nest">
                </a>
            </div>
        </div>

        <div class="ab-center">
            <a href="{% url 'home' %}" class="site-title">
                <span class="home-text">Home</span>
                <span class="accent-text">Nest</span>
            </a>
        </div>

        <div class="ab-right">
            {% if user.is_authenticated %}
            <span class="user-greeting">Xin chào, {% firstof user.full_name user.username user.email %}!</span>
            {% endif %}
            <a href="{% url 'taobaidang' %}" class="host-btn"><i class="fa-solid fa-user-plus"></i> Trở thành host</a>
            
            {% if user.is_authenticated %}
            <!-- Notification Bell -->
            <div class="notification-wrapper">
                <button class="notification-bell" id="notificationBell" aria-label="Thông báo">
                    <i class="fa-regular fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                </button>
                <div class="notification-dropdown" id="notificationDropdown">
                    <div class="notification-header">
                        <h4>Thông báo</h4>
                        <button class="mark-all-read" id="markAllRead">Đánh dấu đã đọc</button>
                    </div>
                    <div class="notification-list" id="notificationList">
                        <div class="notification-loading">Đang tải...</div>
                    </div>
                    <a href="{% url 'notification_list' %}" class="view-all-notifications">Xem tất cả thông báo</a>
                </div>
            </div>
            {% endif %}
            <button class="ab-icon" aria-label="Menu"><i class="fa-solid fa-bars"></i></button>
        </div>
    </nav>
<!-- MENU DROPDOWN -->
<div class="menu-dropdown" id="menuDropdown">

    <!-- ITEM 1 -->
    <a href="{% url 'trungtamtrogiup' %}" class="md-item">
        <i class="fa-regular fa-circle-question"></i>
        Trung tâm trợ giúp
    </a>

    <!-- BLOCK HOST -->
    <a href="{% url 'become_host' %}" class="md-block">
        <div class="left">
            <div class="title">Trở thành host</div>
            <div class="desc">Bắt đầu đón tiếp khách và kiếm thêm thu nhập thật dễ dàng.</div>
        </div>
    </a>

    {% if user.is_authenticated %}
    <a href="{% url 'profile' %}" class="md-item"><i class="fa-regular fa-user"></i> Hồ sơ người dùng</a>
    <a href="{% url 'user_booking_history' %}" class="md-item"><i class="fa-solid fa-calendar-days"></i> Lịch sử thuê nhà</a>
    <a href="{% url 'logout' %}" class="md-item"><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</a>
    {% else %}
    <a href="{% url 'login' %}" class="md-item">Đăng nhập hoặc đăng ký</a>
    {% endif %}

</div>

    <nav class="ab-footer">
        <div class="ab-search">

            <!-- ITEM 1 -->
            <div class="ab-search-item search-trigger" data-panel="location" role="button" tabindex="0">
                <span class="label">Địa điểm</span>
                <span class="value" data-field="location" data-placeholder="Tìm kiếm điểm đến">Tìm kiếm điểm đến</span>
            </div>
            <div class="divider"></div>

            <!-- ITEM 2 -->
            <div class="ab-search-item search-trigger" data-panel="dates" role="button" tabindex="0">
                <span class="label">Thời gian</span>
                <span class="value" data-field="dates" data-placeholder="Thêm ngày">Thêm ngày</span>
            </div>
            <div class="divider"></div>

            <!-- ITEM 3 + SEARCH BUTTON -->
            <div class="search-last search-trigger" data-panel="guests" role="button" tabindex="0">
                <div class="search-last-left">
                    <span class="label">Khách</span>
                    <span class="value" data-field="guests" data-placeholder="Thêm khách">Thêm khách</span>
                </div>
                <button class="ab-search-btn" type="button" aria-label="Tìm kiếm">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>

        </div>
    </nav>

    <!-- SEARCH DROPDOWNS -->
    <div class="ab-search-panels" id="searchPanelWrap" aria-live="polite">
        <div class="search-panel" data-panel="location">
            <div class="panel-header">
                <h3>Địa điểm</h3>
                <p>Khám phá điểm đến gợi ý hoặc nhập nơi bạn muốn đến.</p>
            </div>
            <div class="panel-body location-panel">
                <div class="location-input">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input id="locationInput" type="text" placeholder="Tìm kiếm điểm đến" aria-label="Tìm kiếm điểm đến">
                </div>
                <div class="suggestions">
                    <button class="suggestion-item" type="button" data-place="Lân cận">
                        <div class="icon"><i class="fa-regular fa-compass"></i></div>
                        <div class="text"><span class="title">Lân cận</span><span class="desc">Tìm xung quanh bạn</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Hà Nội">
                        <div class="icon"><i class="fa-solid fa-city"></i></div>
                        <div class="text"><span class="title">Hà Nội</span><span class="desc">Có các thắng cảnh như Nhà hát lớn</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Vũng Tàu">
                        <div class="icon"><i class="fa-solid fa-umbrella-beach"></i></div>
                        <div class="text"><span class="title">Vũng Tàu</span><span class="desc">Có đường bờ biển tuyệt đẹp</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Đà Lạt">
                        <div class="icon"><i class="fa-solid fa-mountain"></i></div>
                        <div class="text"><span class="title">Đà Lạt</span><span class="desc">Phù hợp cho người yêu thiên nhiên</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Hồ Chí Minh">
                        <div class="icon"><i class="fa-solid fa-city"></i></div>
                        <div class="text"><span class="title">Hồ Chí Minh</span><span class="desc">Sôi động, nhiều địa điểm giải trí</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Nha Trang">
                        <div class="icon"><i class="fa-solid fa-water"></i></div>
                        <div class="text"><span class="title">Nha Trang</span><span class="desc">Có các thắng cảnh như Chùa Ponagar</span></div>
                    </button>
                    <button class="suggestion-item" type="button" data-place="Đà Nẵng">
                        <div class="icon"><i class="fa-solid fa-archway"></i></div>
                        <div class="text"><span class="title">Đà Nẵng</span><span class="desc">Điểm đến có bãi biển được ưa chuộng</span></div>
                    </button>
                </div>
            </div>
        </div>

        <div class="search-panel" data-panel="dates">
            <div class="panel-header">
                <h3>Thời gian</h3>
                <p>Chọn khoảng thời gian bạn muốn lưu trú.</p>
            </div>
            <div class="panel-body dates-panel">
                <div class="calendar-wrap">
                    <!-- Calendar Month 1 -->
                    <div class="calendar-month" id="calendarMonth1">
                        <div class="calendar-nav">
                            <button type="button" class="cal-nav-btn prev-month" aria-label="Tháng trước">❮</button>
                            <div class="calendar-heading"></div>
                            <span></span>
                        </div>
                        <div class="calendar-grid" aria-label="Lịch tháng 1"></div>
                    </div>
                    <!-- Calendar Month 2 -->
                    <div class="calendar-month" id="calendarMonth2">
                        <div class="calendar-nav">
                            <span></span>
                            <div class="calendar-heading"></div>
                            <button type="button" class="cal-nav-btn next-month" aria-label="Tháng sau">❯</button>
                        </div>
                        <div class="calendar-grid" aria-label="Lịch tháng 2"></div>
                    </div>
                </div>
                <div class="quick-range">
                    <span>Ngày chính xác</span>
                    <div class="range-buttons">
                        <button type="button" class="range-btn" data-range="1">± 1 ngày</button>
                        <button type="button" class="range-btn" data-range="2">± 2 ngày</button>
                        <button type="button" class="range-btn" data-range="3">± 3 ngày</button>
                        <button type="button" class="range-btn" data-range="7">± 7 ngày</button>
                        <button type="button" class="range-btn" data-range="14">± 14 ngày</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="search-panel" data-panel="guests">
            <div class="panel-header">
                <h3>Khách</h3>
                <p>Thêm số lượng người lớn, trẻ em, em bé và thú cưng.</p>
            </div>
            <div class="panel-body guests-panel">
                <div class="guest-row" data-field="adults">
                    <div class="guest-info">
                        <div class="title">Người lớn</div>
                        <div class="desc">Từ 13 tuổi trở lên</div>
                    </div>
                    <div class="counter">
                        <button type="button" class="count-btn minus" aria-label="Giảm người lớn">-</button>
                        <span class="count" aria-live="polite">0</span>
                        <button type="button" class="count-btn plus" aria-label="Tăng người lớn">+</button>
                    </div>
                </div>
                <div class="guest-row" data-field="children">
                    <div class="guest-info">
                        <div class="title">Trẻ em</div>
                        <div class="desc">Độ tuổi 2 – 12</div>
                    </div>
                    <div class="counter">
                        <button type="button" class="count-btn minus" aria-label="Giảm trẻ em">-</button>
                        <span class="count" aria-live="polite">0</span>
                        <button type="button" class="count-btn plus" aria-label="Tăng trẻ em">+</button>
                    </div>
                </div>
                <div class="guest-row" data-field="infants">
                    <div class="guest-info">
                        <div class="title">Em bé</div>
                        <div class="desc">Dưới 2 tuổi</div>
                    </div>
                    <div class="counter">
                        <button type="button" class="count-btn minus" aria-label="Giảm em bé">-</button>
                        <span class="count" aria-live="polite">0</span>
                        <button type="button" class="count-btn plus" aria-label="Tăng em bé">+</button>
                    </div>
                </div>
                <div class="guest-row" data-field="pets">
                    <div class="guest-info">
                        <div class="title">Thú cưng</div>
                        <div class="desc">Bạn sẽ mang theo động vật phục vụ?</div>
                    </div>
                    <div class="counter">
                        <button type="button" class="count-btn minus" aria-label="Giảm thú cưng">-</button>
                        <span class="count" aria-live="polite">0</span>
                        <button type="button" class="count-btn plus" aria-label="Tăng thú cưng">+</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="search-backdrop" id="searchBackdrop"></div>

</header>

<!-- Load header behavior deferred to avoid blocking render -->
<script src="{% static 'app/js/header.js' %}?v=2" defer></script>
